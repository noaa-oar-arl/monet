

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorial - How to read AQS data from PAMS and do a quick analysis &mdash; MONET  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/noaa.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../why-monet.html">Overview: Why MONET?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Help * Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">Get in touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html#api">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MONET</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Tutorial - How to read AQS data from PAMS and do a quick analysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/tutorial/.ipynb_checkpoints/aqs_pams-checkpoint.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 8ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="Tutorial---How-to-read-AQS-data-from-PAMS-and-do-a-quick-analysis">
<h1>Tutorial - How to read AQS data from PAMS and do a quick analysis<a class="headerlink" href="#Tutorial---How-to-read-AQS-data-from-PAMS-and-do-a-quick-analysis" title="Permalink to this headline">¶</a></h1>
<p>The first tutorial for MONET will load data from the AQS data,
specifically the PAMS dataset, and show to reshape the dataframe and do
a statistical analysis with different meteorological and composition
data. For more examples, please see
<a class="reference external" href="http://monet-arl.readthedocs.io/en/develop/">http://monet-arl.readthedocs.io/en/develop/</a>. This will later be able to
be found on the github page and readthedocs.</p>
<p>We will first begin by importing monet and a few helper classes for
later</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>          <span class="c1"># numpy</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>         <span class="c1"># pandas</span>
<span class="kn">from</span> <span class="nn">monet.obs</span> <span class="k">import</span> <span class="o">*</span>     <span class="c1"># observations from MONET</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># plotting</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>       <span class="c1"># better color palettes</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>  <span class="c1"># map projections</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span> <span class="c1"># politcal and geographic features</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;ticks&#39;</span><span class="p">)</span>   <span class="c1"># plot configuration</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s2">&quot;talk&quot;</span><span class="p">)</span>  <span class="c1"># plot configure for size of text</span>
</pre></div>
</div>
</div>
<p>Now we have all the imports we could need lets load some data. Most of
the PAMS data is on daily data so lets add the kwarg daily=True to the
call. We will also create this for the year 2015 and 2016. Some
variables that may be valuable are the VOCS, ozone, NO2, NOX,
temperature. For all of the measurments available please see
<a class="reference external" href="https://aqs.epa.gov/aqsweb/airdata/download_files.html">https://aqs.epa.gov/aqsweb/airdata/download_files.html</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2004-01-01&#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;2004-12-31&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">aqs</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">daily</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">param</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;VOC&#39;</span><span class="p">,</span><span class="s1">&#39;OZONE&#39;</span><span class="p">],</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

 Retrieving: daily_VOCS_2004.zip
https://aqs.epa.gov/aqsweb/airdata/daily_VOCS_2004.zip



 Retrieving: daily_44201_2004.zip
https://aqs.epa.gov/aqsweb/airdata/daily_44201_2004.zip


[########################################] | 100% Completed | 26.1s
[########################################] | 100% Completed | 26.2s
[########################################] | 100% Completed | 26.3s
[########################################] | 100% Completed | 26.4s
[########################################] | 100% Completed | 26.5s
[########################################] | 100% Completed | 34.8s
[########################################] | 100% Completed | 34.9s
[########################################] | 100% Completed | 34.9s
[########################################] | 100% Completed | 35.0s
[########################################] | 100% Completed | 35.1s
Monitor File Path: /anaconda3/lib/python3.6/site-packages/data/monitoring_site_locations.hdf
Monitor File Not Found... Reprocessing
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2963: DtypeWarning: Columns (0) have mixed types. Specify dtype option on import or set low_memory=False.
  exec(code_obj, self.user_global_ns, self.user_ns)
/anaconda3/lib/python3.6/site-packages/pandas/core/indexing.py:189: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  self._setitem_with_indexer(indexer, value)
</pre></div></div>
</div>
<p>Now we have the data in aqs.df and a copy of it in df… just in case. So
lets take a look at it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#df.head()</span>
<span class="n">aqs</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time_local</th>
      <th>state_code</th>
      <th>county_code</th>
      <th>site_num</th>
      <th>parameter_code</th>
      <th>poc</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>datum</th>
      <th>parameter_name</th>
      <th>...</th>
      <th>first_year_of_data</th>
      <th>gmt_offset</th>
      <th>land_use</th>
      <th>location_setting</th>
      <th>monitor_type</th>
      <th>msa_code</th>
      <th>networks</th>
      <th>state_name</th>
      <th>tribe_name</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2004-05-15</td>
      <td>04</td>
      <td>013</td>
      <td>4003</td>
      <td>43000</td>
      <td>10</td>
      <td>33.40316</td>
      <td>-112.07533</td>
      <td>WGS84</td>
      <td>Sum of PAMS target compounds</td>
      <td>...</td>
      <td>NaN</td>
      <td>-7.0</td>
      <td>RESIDENTIAL</td>
      <td>URBAN AND CENTER CITY</td>
      <td>OTHER</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AZ</td>
      <td>NaN</td>
      <td>2004-05-15 07:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2004-05-21</td>
      <td>04</td>
      <td>013</td>
      <td>4003</td>
      <td>43000</td>
      <td>10</td>
      <td>33.40316</td>
      <td>-112.07533</td>
      <td>WGS84</td>
      <td>Sum of PAMS target compounds</td>
      <td>...</td>
      <td>NaN</td>
      <td>-7.0</td>
      <td>RESIDENTIAL</td>
      <td>URBAN AND CENTER CITY</td>
      <td>OTHER</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AZ</td>
      <td>NaN</td>
      <td>2004-05-21 07:00:00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2004-05-27</td>
      <td>04</td>
      <td>013</td>
      <td>4003</td>
      <td>43000</td>
      <td>10</td>
      <td>33.40316</td>
      <td>-112.07533</td>
      <td>WGS84</td>
      <td>Sum of PAMS target compounds</td>
      <td>...</td>
      <td>NaN</td>
      <td>-7.0</td>
      <td>RESIDENTIAL</td>
      <td>URBAN AND CENTER CITY</td>
      <td>OTHER</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AZ</td>
      <td>NaN</td>
      <td>2004-05-27 07:00:00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2004-06-02</td>
      <td>04</td>
      <td>013</td>
      <td>4003</td>
      <td>43000</td>
      <td>10</td>
      <td>33.40316</td>
      <td>-112.07533</td>
      <td>WGS84</td>
      <td>Sum of PAMS target compounds</td>
      <td>...</td>
      <td>NaN</td>
      <td>-7.0</td>
      <td>RESIDENTIAL</td>
      <td>URBAN AND CENTER CITY</td>
      <td>OTHER</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AZ</td>
      <td>NaN</td>
      <td>2004-06-02 07:00:00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2004-06-08</td>
      <td>04</td>
      <td>013</td>
      <td>4003</td>
      <td>43000</td>
      <td>10</td>
      <td>33.40316</td>
      <td>-112.07533</td>
      <td>WGS84</td>
      <td>Sum of PAMS target compounds</td>
      <td>...</td>
      <td>NaN</td>
      <td>-7.0</td>
      <td>RESIDENTIAL</td>
      <td>URBAN AND CENTER CITY</td>
      <td>OTHER</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>AZ</td>
      <td>NaN</td>
      <td>2004-06-08 07:00:00</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 46 columns</p>
</div></div>
</div>
<p>Notice that in this printed format it obscures some of the dataframe
columns from view. Lets see what they are!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">sort</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sort</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span> <span class="c1"># loop over the sorted columns and print them</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1st_max_hour
1st_max_value
address
airnow_flag
aqi
cbsa_name
city_name
cmsa_name
collecting_agency
county_code
county_name
date_of_last_change
datum
elevation
epa_region
event_type
first_year_of_data
gmt_offset
land_use
latitude
local_site_name
location_setting
longitude
method_code
method_name
monitor_type
msa_code
msa_name
networks
obs
observation_count
observation_percent
parameter_code
parameter_name
poc
pollutant_standard
sample_duration
site_num
siteid
state_code
state_name
time
time_local
tribe_name
units
variable
</pre></div></div>
</div>
<p>We have lots of columns but this is actually the long format (data is
stacked on variable). Data analysis could be done easier in a wide
format. So lets use a utility function in MONET to aid with reshaping
the dataframe.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">monet.util</span> <span class="k">import</span> <span class="n">tools</span>
<span class="n">new</span> <span class="o">=</span> <span class="n">tools</span><span class="o">.</span><span class="n">long_to_wide</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">new</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>siteid</th>
      <th>1,1,2,2-TETRACHLOROETHANE</th>
      <th>1,1,2-TRICHLORO-1,2,2-TRIFLUOROETHANE</th>
      <th>1,1,2-TRICHLOROETHANE</th>
      <th>1,1-DICHLOROETHANE</th>
      <th>1,1-DICHLOROETHYLENE</th>
      <th>1,2,3-TRIMETHYLBENZENE</th>
      <th>1,2,4-TRICHLOROBENZENE</th>
      <th>1,2,4-TRIMETHYLBENZENE</th>
      <th>...</th>
      <th>epa_region</th>
      <th>first_year_of_data</th>
      <th>gmt_offset</th>
      <th>land_use</th>
      <th>location_setting</th>
      <th>monitor_type</th>
      <th>msa_code</th>
      <th>networks</th>
      <th>state_name</th>
      <th>tribe_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2004-01-01 05:00:00</td>
      <td>090031003</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2002.0</td>
      <td>-5.0</td>
      <td>RESIDENTIAL</td>
      <td>SUBURBAN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CT</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2004-01-01 05:00:00</td>
      <td>100031007</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2003.0</td>
      <td>-5.0</td>
      <td>AGRICULTURAL</td>
      <td>RURAL</td>
      <td>OTHER</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>DE</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2004-01-01 05:00:00</td>
      <td>100031013</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>2003.0</td>
      <td>-5.0</td>
      <td>RESIDENTIAL</td>
      <td>SUBURBAN</td>
      <td>SLAMS</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>DE</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2004-01-01 05:00:00</td>
      <td>110010025</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1980.0</td>
      <td>-5.0</td>
      <td>COMMERCIAL</td>
      <td>URBAN AND CENTER CITY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>District Of Columbia</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2004-01-01 05:00:00</td>
      <td>110010041</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>1993.0</td>
      <td>-5.0</td>
      <td>RESIDENTIAL</td>
      <td>URBAN AND CENTER CITY</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>District Of Columbia</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 157 columns</p>
</div></div>
</div>
<p>Lets see how many ISOPRENE sites there are. We will drop the NaN values
along the ISOPRENE column and then find the unique siteid’s and look at
the shape of them</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ISOPRENE&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">siteid</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(140,)
</pre></div>
</div>
</div>
<p>Now as you can see we have lots of columns that is sorted by time and
siteid. But what measurements are included in the dataframe? Let’s see
all the new columns generated from pivoting the table.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">sort</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sort</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">columns</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1,1,2,2-TETRACHLOROETHANE
1,1,2-TRICHLORO-1,2,2-TRIFLUOROETHANE
1,1,2-TRICHLOROETHANE
1,1-DICHLOROETHANE
1,1-DICHLOROETHYLENE
1,2,3-TRIMETHYLBENZENE
1,2,4-TRICHLOROBENZENE
1,2,4-TRIMETHYLBENZENE
1,2-DICHLOROBENZENE
1,2-DICHLOROPROPANE
1,3,5-TRIMETHYLBENZENE
1,3-BUTADIENE
1,3-DICHLOROBENZENE
1,4-DICHLOROBENZENE
1-BUTENE
1-PENTENE
1st_max_hour
1st_max_value
2,2,4-TRIMETHYLPENTANE
2,2-DIMETHYLBUTANE
2,3,4-TRIMETHYLPENTANE
2,3-DIMETHYLBUTANE
2,3-DIMETHYLPENTANE
2,4-DIMETHYLPENTANE
2-METHYLHEPTANE
2-METHYLHEXANE
2-METHYLPENTANE
3-CHLOROPROPENE
3-METHYLHEPTANE
3-METHYLHEXANE
3-METHYLPENTANE
ACETALDEHYDE
ACETONE
ACETONITRILE
ACETYLENE
ACROLEIN - UNVERIFIED
ACRYLONITRILE
BENZENE
BENZYL CHLORIDE
BROMOCHLOROMETHANE
BROMODICHLOROMETHANE
BROMOFORM
BROMOMETHANE
CARBON DISULFIDE
CARBON TETRACHLORIDE
CHLOROBENZENE
CHLOROETHANE
CHLOROFORM
CHLOROMETHANE
CHLOROPRENE
CIS-1,2-DICHLOROETHENE
CIS-1,3-DICHLOROPROPENE
CIS-2-BUTENE
CIS-2-PENTENE
CYCLOHEXANE
CYCLOPENTANE
DIBROMOCHLOROMETHANE
DICHLORODIFLUOROMETHANE
DICHLOROMETHANE
ETHANE
ETHYL ACRYLATE
ETHYLBENZENE
ETHYLENE
ETHYLENE DIBROMIDE
ETHYLENE DICHLORIDE
FORMALDEHYDE
FREON 113
FREON 114
HEXACHLOROBUTADIENE
ISOBUTANE
ISOPENTANE
ISOPRENE
ISOPROPYLBENZENE
M-DIETHYLBENZENE
M-ETHYLTOLUENE
M/P XYLENE
METHYL CHLOROFORM
METHYL ETHYL KETONE
METHYL ISOBUTYL KETONE
METHYL METHACRYLATE
METHYL TERT-BUTYL ETHER
METHYLCYCLOHEXANE
METHYLCYCLOPENTANE
N-BUTANE
N-DECANE
N-HEPTANE
N-HEXANE
N-NONANE
N-OCTANE
N-PENTANE
N-PROPYLBENZENE
N-UNDECANE
O-ETHYLTOLUENE
O-XYLENE
OZONE
P-DIETHYLBENZENE
P-ETHYLTOLUENE
PROPANE
PROPYLENE
STYRENE
SUM OF PAMS TARGET COMPOUNDS
TERT-AMYL METHYL ETHER
TERT-BUTYL ETHYL ETHER
TETRACHLOROETHYLENE
TOLUENE
TOTAL NMOC (NON-METHANE ORGANIC COMPOUND)
TRANS-1,2-DICHLOROETHYLENE
TRANS-1,3-DICHLOROPROPENE
TRANS-2-BUTENE
TRANS-2-PENTENE
TRICHLOROETHYLENE
TRICHLOROFLUOROMETHANE
VINYL CHLORIDE
address
airnow_flag
aqi
cbsa_name
city_name
cmsa_name
collecting_agency
county_code
county_name
date_of_last_change
datum
elevation
epa_region
event_type
first_year_of_data
gmt_offset
land_use
latitude
local_site_name
location_setting
longitude
method_code
method_name
monitor_type
msa_code
msa_name
networks
obs
observation_count
observation_percent
parameter_code
parameter_name
poc
pollutant_standard
sample_duration
site_num
siteid
state_code
state_name
time
time_local
tribe_name
units
variable
</pre></div></div>
</div>
<p>Now as you can see we have lots of columns that is sorted by time and
siteid. This can be very useful as we can now do some direct comparisons
using the dataframe. Lets get a description of the dataset first so we
can see some averages and ranges of the different chemical species.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1,1,2,2-TETRACHLOROETHANE</th>
      <th>1,1,2-TRICHLORO-1,2,2-TRIFLUOROETHANE</th>
      <th>1,1,2-TRICHLOROETHANE</th>
      <th>1,1-DICHLOROETHANE</th>
      <th>1,1-DICHLOROETHYLENE</th>
      <th>1,2,3-TRIMETHYLBENZENE</th>
      <th>1,2,4-TRICHLOROBENZENE</th>
      <th>1,2,4-TRIMETHYLBENZENE</th>
      <th>1,2-DICHLOROBENZENE</th>
      <th>1,2-DICHLOROPROPANE</th>
      <th>...</th>
      <th>obs</th>
      <th>1st_max_value</th>
      <th>1st_max_hour</th>
      <th>aqi</th>
      <th>method_code</th>
      <th>cmsa_name</th>
      <th>elevation</th>
      <th>first_year_of_data</th>
      <th>gmt_offset</th>
      <th>msa_code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>714352.000000</td>
      <td>132606.000000</td>
      <td>665982.000000</td>
      <td>475211.000000</td>
      <td>704962.000000</td>
      <td>766240.000000</td>
      <td>407466.000000</td>
      <td>1.105874e+06</td>
      <td>441391.000000</td>
      <td>713931.000000</td>
      <td>...</td>
      <td>1.501618e+06</td>
      <td>1.501618e+06</td>
      <td>1.501618e+06</td>
      <td>335758.000000</td>
      <td>1.165860e+06</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.393782e+06</td>
      <td>1.501618e+06</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.020421</td>
      <td>0.169611</td>
      <td>0.019323</td>
      <td>0.012979</td>
      <td>0.020375</td>
      <td>0.474538</td>
      <td>0.111623</td>
      <td>1.011792e+00</td>
      <td>0.129964</td>
      <td>0.030783</td>
      <td>...</td>
      <td>3.764996e+00</td>
      <td>8.070852e+00</td>
      <td>5.336468e+00</td>
      <td>37.632730</td>
      <td>1.404985e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.993263e+03</td>
      <td>-5.978275e+00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.157866</td>
      <td>0.215456</td>
      <td>0.158109</td>
      <td>0.185480</td>
      <td>0.178133</td>
      <td>1.307923</td>
      <td>1.129665</td>
      <td>2.255642e+00</td>
      <td>0.947958</td>
      <td>0.230669</td>
      <td>...</td>
      <td>3.997054e+01</td>
      <td>1.091979e+02</td>
      <td>6.966935e+00</td>
      <td>19.249021</td>
      <td>2.685583e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.223728e+01</td>
      <td>1.006215e+00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>1.100000e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.959000e+03</td>
      <td>-1.000000e+01</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.100000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.050000</td>
      <td>0.000000</td>
      <td>1.800000e-01</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>2.000000e-02</td>
      <td>3.000000e-02</td>
      <td>0.000000e+00</td>
      <td>26.000000</td>
      <td>1.260000e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.982000e+03</td>
      <td>-6.000000e+00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>0.180000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.230000</td>
      <td>0.000000</td>
      <td>5.000000e-01</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>8.000000e-02</td>
      <td>1.000000e-01</td>
      <td>0.000000e+00</td>
      <td>35.000000</td>
      <td>1.280000e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.997000e+03</td>
      <td>-6.000000e+00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.010000</td>
      <td>0.220000</td>
      <td>0.010000</td>
      <td>0.000000</td>
      <td>0.010000</td>
      <td>0.468182</td>
      <td>0.000000</td>
      <td>1.219583e+00</td>
      <td>0.000000</td>
      <td>0.020000</td>
      <td>...</td>
      <td>6.600000e-01</td>
      <td>1.000000e+00</td>
      <td>1.000000e+01</td>
      <td>43.000000</td>
      <td>1.740000e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.003000e+03</td>
      <td>-5.000000e+00</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>10.000000</td>
      <td>39.266667</td>
      <td>54.700000</td>
      <td>1.493500e+02</td>
      <td>59.880000</td>
      <td>15.000000</td>
      <td>...</td>
      <td>9.474708e+03</td>
      <td>3.854257e+04</td>
      <td>2.300000e+01</td>
      <td>212.000000</td>
      <td>2.110000e+02</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.018000e+03</td>
      <td>-4.000000e+00</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 127 columns</p>
</div></div>
</div>
<p>This gives us a format that allows simple statistics and plots using
pandas, matplotlib, and seaborn. For time series it is often useful to
have the index as the time. Lets do that</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">time</span>
<span class="n">new</span><span class="p">[</span><span class="s1">&#39;OZONE_ppb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">OZONE</span> <span class="o">*</span> <span class="mf">1000.</span>
<span class="n">new</span><span class="o">.</span><span class="n">OZONE_ppb</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[9]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>27.581303457170307
</pre></div>
</div>
</div>
<p>As you can see the data is now indexed with the UTC time. Lets make a
time series plot of the average ISOPRENE.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># this is so we can control the figure size.</span>
<span class="n">new</span><span class="o">.</span><span class="n">ISOPRENE</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[10]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1c2bb1f860&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_20_1.png" src="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_20_1.png" />
</div>
</div>
<p>This is quite noisy with the daily data. Lets resample in time to every
month using the average Isoprene concentration to weekly and monthly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># this is so we can control the figure size.</span>
<span class="n">new</span><span class="o">.</span><span class="n">ISOPRENE</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">)</span>
<span class="n">new</span><span class="o">.</span><span class="n">ISOPRENE</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;weekly&#39;</span><span class="p">)</span>
<span class="n">new</span><span class="o">.</span><span class="n">ISOPRENE</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ISOP&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_22_0.png" src="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_22_0.png" />
</div>
</div>
<p>Where are these measurements. Lets plot this on a map and see where it
is. We can use a utility plotting function in monet to generate the plot</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">monet</span> <span class="k">import</span> <span class="n">plots</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plots</span><span class="o">.</span><span class="n">draw_map</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">130</span><span class="p">,</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;10m&#39;</span><span class="p">)</span>
<span class="c1"># get only where ISOPRENE is not NAN</span>
<span class="n">isop</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ISOPRENE&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">isop</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">isop</span><span class="o">.</span><span class="n">latitude</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.collections.PathCollection at 0x1c47460f60&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_24_1.png" src="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_24_1.png" />
</div>
</div>
<p>There are monitors all across the US with many in TX, CA, New England
and the Mid-Atlantic.</p>
<p>What if we wanted to do a linear regression between two variables. Lets
say OZONE and temperature. To do this we will use the statsmodels
package. It is a robust library for curve fitting. For specific
information for this module look here
<a class="reference external" href="https://www.statsmodels.org/stable/index.html">https://www.statsmodels.org/stable/index.html</a></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span> <span class="c1"># load statsmodels api</span>
<span class="c1">#first clean of nan values</span>
<span class="n">fit_df</span> <span class="o">=</span> <span class="n">new</span><span class="p">[[</span><span class="s1">&#39;ISOPRENE&#39;</span><span class="p">,</span><span class="s1">&#39;OZONE&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">fit_df</span><span class="o">.</span><span class="n">ISOPRENE</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">fit_df</span><span class="o">.</span><span class="n">OZONE</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>

<span class="n">fit_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;ISOPRENE&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;OZONE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">result</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;--r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                            OLS Regression Results
==============================================================================
Dep. Variable:                  OZONE   R-squared:                       0.248
Model:                            OLS   Adj. R-squared:                  0.248
Method:                 Least Squares   F-statistic:                 1.833e+05
Date:                Tue, 19 Jun 2018   Prob (F-statistic):               0.00
Time:                        09:31:12   Log-Likelihood:             1.2390e+06
No. Observations:              556733   AIC:                        -2.478e+06
Df Residuals:                  556732   BIC:                        -2.478e+06
Df Model:                           1
Covariance Type:            nonrobust
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
ISOPRENE       0.0057   1.33e-05    428.134      0.000       0.006       0.006
==============================================================================
Omnibus:                   205153.426   Durbin-Watson:                   0.007
Prob(Omnibus):                  0.000   Jarque-Bera (JB):          2465877.353
Skew:                          -1.433   Prob(JB):                         0.00
Kurtosis:                      12.904   Cond. No.                         1.00
==============================================================================

Warnings:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[13]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&lt;matplotlib.lines.Line2D at 0x1c1e7f0f28&gt;]
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_26_2.png" src="../../_images/tutorial_.ipynb_checkpoints_aqs_pams-checkpoint_26_2.png" />
</div>
</div>
<p>Lets save this to a csv file</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">new</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/Users/barry/Desktop/new.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Barry Baker.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>