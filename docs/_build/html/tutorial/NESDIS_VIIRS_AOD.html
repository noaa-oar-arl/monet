

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>NOAA NESDIS AOD &mdash; MONET  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FV3-CHEM in MONET" href="fv3chem_tutorial.html" />
    <link rel="prev" title="How to Open and View CMAQ simulations - HI Volcano Example" href="CMAQ_hi_volcano.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/Monet-transparent.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../why-monet.html">Overview: Why MONET?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../monet-accessor.html">MONET XArray Accessor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../observations.html">Observations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">Models</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aqs_pams.html">How to read AQS data from PAMS and do a quick analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="improve_trends_kmeans.html">Loading IMPROVE Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_hi_volcano.html">How to Open and View CMAQ simulations - HI Volcano Example</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NOAA NESDIS AOD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#viirs-edr">VIIRS EDR</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#open-multiple-days">Open Multiple Days</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#viirs-eps">VIIRS EPS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fv3chem_tutorial.html">FV3-CHEM in MONET</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Help * Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Get in touch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html#api">API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MONET</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorial.html">Tutorial</a> &raquo;</li>
        
      <li>NOAA NESDIS AOD</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorial/NESDIS_VIIRS_AOD.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="noaa-nesdis-aod">
<h1>NOAA NESDIS AOD<a class="headerlink" href="#noaa-nesdis-aod" title="Permalink to this headline">¶</a></h1>
<p>NOAA NESDIS has an operational data product for the aerosol optical
depth from the VIIRS satellite. There are two products, the viirs edr
and viirs eps available from <a class="reference external" href="ftp://ftp.star.nesdis.noaa.gov/pub/smcd/">ftp://ftp.star.nesdis.noaa.gov/pub/smcd/</a>.</p>
<div class="section" id="viirs-edr">
<h2>VIIRS EDR<a class="headerlink" href="#viirs-edr" title="Permalink to this headline">¶</a></h2>
<p>The VIIRS EDR data is an aerosol optical depth product available at 0.1
and 0.25 degree resolution. This VIIRS EDR product also does not include
the Blue Sky algorithm to retrieve over bright surfaces such as the
Sahara. Lets open the data on a single day at first, in this case
‘2018-07-05’.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">monet.sat</span> <span class="k">import</span> <span class="n">nesdis_edr_viirs</span>
<span class="n">edr</span> <span class="o">=</span> <span class="n">nesdis_edr_viirs</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;2018-07-05&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">edr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;VIIRS EDR AOD&#39;</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3600</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">]]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">time</span>       <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span>
  <span class="o">*</span> <span class="n">y</span>          <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="n">int64</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="o">...</span> <span class="mi">1793</span> <span class="mi">1794</span> <span class="mi">1795</span> <span class="mi">1796</span> <span class="mi">1797</span> <span class="mi">1798</span> <span class="mi">1799</span>
  <span class="o">*</span> <span class="n">x</span>          <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">int64</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="o">...</span> <span class="mi">3593</span> <span class="mi">3594</span> <span class="mi">3595</span> <span class="mi">3596</span> <span class="mi">3597</span> <span class="mi">3598</span> <span class="mi">3599</span>
    <span class="n">latitude</span>   <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">...</span> <span class="mf">89.88</span> <span class="mf">89.88</span> <span class="mf">89.88</span>
    <span class="n">longitude</span>  <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">179.9</span> <span class="o">-</span><span class="mf">179.8</span> <span class="o">-</span><span class="mf">179.7</span> <span class="o">-</span><span class="mf">179.6</span> <span class="o">...</span> <span class="mf">179.7</span> <span class="mf">179.8</span> <span class="mf">179.9</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">units</span><span class="p">:</span>
    <span class="n">long_name</span><span class="p">:</span>  <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span>
    <span class="n">source</span><span class="p">:</span>     <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">nesdis</span><span class="o">.</span><span class="n">noaa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">smcd</span><span class="o">/</span><span class="n">jhuang</span><span class="o">/</span><span class="n">npp</span><span class="o">.</span><span class="n">viirs</span><span class="o">.</span><span class="n">aero</span><span class="o">...</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">edr</span></code> is now a <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code> for that day. The
<code class="docutils literal notranslate"><span class="pre">nesdis_edr_viirs</span></code> module downloads data to the current directory. To
download this into a different directory you can supply the
<code class="docutils literal notranslate"><span class="pre">datapath=</span></code> keyword if needed. To quickly view this you can use the
<code class="docutils literal notranslate"><span class="pre">monet</span></code> accessor.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">edr</span><span class="o">.</span><span class="n">monet</span><span class="o">.</span><span class="n">quick_map</span><span class="p">(</span><span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">cartopy</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">geoaxes</span><span class="o">.</span><span class="n">GeoAxesSubplot</span> <span class="n">at</span> <span class="mh">0x1022a77470</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../_images/nesdis_viirs_aod_1.png" src="../_images/nesdis_viirs_aod_1.png" />
<p>The EDR data is available in two resolutions. By default <code class="docutils literal notranslate"><span class="pre">monet</span></code> will
download the 0.1 degree dataset. If you would like the 0.25 degree
dataset you can pass the kwarg <code class="docutils literal notranslate"><span class="pre">resolution='low'</span></code>.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">edr</span> <span class="o">=</span> <span class="n">nesdis_edr_viirs</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;2018-07-05&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">edr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;VIIRS EDR AOD&#39;</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">720</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1440</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">]]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">time</span>       <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span>
  <span class="o">*</span> <span class="n">y</span>          <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="n">int64</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="o">...</span> <span class="mi">712</span> <span class="mi">713</span> <span class="mi">714</span> <span class="mi">715</span> <span class="mi">716</span> <span class="mi">717</span> <span class="mi">718</span> <span class="mi">719</span>
  <span class="o">*</span> <span class="n">x</span>          <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">int64</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="o">...</span> <span class="mi">1433</span> <span class="mi">1434</span> <span class="mi">1435</span> <span class="mi">1436</span> <span class="mi">1437</span> <span class="mi">1438</span> <span class="mi">1439</span>
    <span class="n">latitude</span>   <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">...</span> <span class="mf">89.88</span> <span class="mf">89.88</span> <span class="mf">89.88</span>
    <span class="n">longitude</span>  <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">179.9</span> <span class="o">-</span><span class="mf">179.6</span> <span class="o">-</span><span class="mf">179.4</span> <span class="o">-</span><span class="mf">179.1</span> <span class="o">...</span> <span class="mf">179.4</span> <span class="mf">179.6</span> <span class="mf">179.9</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">units</span><span class="p">:</span>
    <span class="n">long_name</span><span class="p">:</span>  <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span>
    <span class="n">source</span><span class="p">:</span>     <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">nesdis</span><span class="o">.</span><span class="n">noaa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">smcd</span><span class="o">/</span><span class="n">jhuang</span><span class="o">/</span><span class="n">npp</span><span class="o">.</span><span class="n">viirs</span><span class="o">.</span><span class="n">aero</span><span class="o">...</span>
</pre></div>
</div>
<p>Notice that the dimensions changed from 1800x3600 to 720x1440.</p>
<div class="section" id="open-multiple-days">
<h3>Open Multiple Days<a class="headerlink" href="#open-multiple-days" title="Permalink to this headline">¶</a></h3>
<p>If you want to open multiple days in a sinlge call you could use the
open_mfdataset. Lets grab the first nine days of July 2018.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;2018-07-01&#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;2018-07-09&#39;</span><span class="p">)</span>
<span class="n">edr</span> <span class="o">=</span> <span class="n">nesdis_edr_viirs</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edr</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;VIIRS EDR AOD&#39;</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="mi">3600</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">]],</span>

       <span class="o">...</span><span class="p">,</span>

       <span class="p">[[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">]]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">y</span>          <span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="n">int64</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="o">...</span> <span class="mi">1793</span> <span class="mi">1794</span> <span class="mi">1795</span> <span class="mi">1796</span> <span class="mi">1797</span> <span class="mi">1798</span> <span class="mi">1799</span>
  <span class="o">*</span> <span class="n">x</span>          <span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="n">int64</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="o">...</span> <span class="mi">3593</span> <span class="mi">3594</span> <span class="mi">3595</span> <span class="mi">3596</span> <span class="mi">3597</span> <span class="mi">3598</span> <span class="mi">3599</span>
    <span class="n">latitude</span>   <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">...</span> <span class="mf">89.88</span> <span class="mf">89.88</span> <span class="mf">89.88</span>
    <span class="n">longitude</span>  <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">179.9</span> <span class="o">-</span><span class="mf">179.8</span> <span class="o">-</span><span class="mf">179.7</span> <span class="o">-</span><span class="mf">179.6</span> <span class="o">...</span> <span class="mf">179.7</span> <span class="mf">179.8</span> <span class="mf">179.9</span>
  <span class="o">*</span> <span class="n">time</span>       <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">02</span> <span class="o">...</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">09</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">units</span><span class="p">:</span>
    <span class="n">long_name</span><span class="p">:</span>  <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span>
    <span class="n">source</span><span class="p">:</span>     <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">nesdis</span><span class="o">.</span><span class="n">noaa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">smcd</span><span class="o">/</span><span class="n">jhuang</span><span class="o">/</span><span class="n">npp</span><span class="o">.</span><span class="n">viirs</span><span class="o">.</span><span class="n">aero</span><span class="o">...</span>
</pre></div>
</div>
<p>We can visualize these in a seaborn FacetGrid through xarray. For more
information on FacetGrid in <code class="docutils literal notranslate"><span class="pre">xarray</span></code> plotting please look here:
<a class="reference external" href="http://xarray.pydata.org/en/stable/plotting.html#faceting">http://xarray.pydata.org/en/stable/plotting.html#faceting</a></p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span> <span class="c1"># map projections and coastlines</span>
<span class="n">cbar_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">edr</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;longitude&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">col_wrap</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cbar_kwargs</span><span class="o">=</span><span class="n">cbar_kwargs</span><span class="p">,</span>
                       <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>
<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/nesdis_viirs_aod_0.png" src="../_images/nesdis_viirs_aod_0.png" />
</div>
</div>
<div class="section" id="viirs-eps">
<h2>VIIRS EPS<a class="headerlink" href="#viirs-eps" title="Permalink to this headline">¶</a></h2>
<p>The VIIRS EPS data includes the Blue Sky algorithm in the AOD
calculation. The same methods are available as with the
<code class="docutils literal notranslate"><span class="pre">nesdis_edr_viirs</span></code> methods.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">monet.sat</span> <span class="k">import</span> <span class="n">nesdis_eps_viirs</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">nesdis_eps_viirs</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;2018-07-05&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;VIIRS EPS AOT&#39;</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">720</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1440</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">]]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
<span class="n">Coordinates</span><span class="p">:</span>
    <span class="n">latitude</span>   <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">89.88</span> <span class="mf">89.88</span> <span class="mf">89.88</span> <span class="mf">89.88</span> <span class="o">...</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span> <span class="o">-</span><span class="mf">89.88</span>
    <span class="n">longitude</span>  <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">179.9</span> <span class="o">-</span><span class="mf">179.6</span> <span class="o">-</span><span class="mf">179.4</span> <span class="o">-</span><span class="mf">179.1</span> <span class="o">...</span> <span class="mf">179.4</span> <span class="mf">179.6</span> <span class="mf">179.9</span>
  <span class="o">*</span> <span class="n">time</span>       <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span>
<span class="n">Dimensions</span> <span class="n">without</span> <span class="n">coordinates</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">units</span><span class="p">:</span>
    <span class="n">long_name</span><span class="p">:</span>  <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Thickness</span>
    <span class="n">source</span><span class="p">:</span>     <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">star</span><span class="o">.</span><span class="n">nesdis</span><span class="o">.</span><span class="n">noaa</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">smcd</span><span class="o">/</span><span class="n">VIIRS_Aerosol</span><span class="o">/</span><span class="n">npp</span><span class="o">.</span><span class="n">vii</span><span class="o">...</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eps</span><span class="o">.</span><span class="n">monet</span><span class="o">.</span><span class="n">quick_map</span><span class="p">(</span><span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">cartopy</span><span class="o">.</span><span class="n">mpl</span><span class="o">.</span><span class="n">geoaxes</span><span class="o">.</span><span class="n">GeoAxesSubplot</span> <span class="n">at</span> <span class="mh">0x1c3406d080</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="../_images/nesdis_viirs_aod_2.png" src="../_images/nesdis_viirs_aod_2.png" />
<p>Notice that there are AOD values over deserts such as the Sahara,
Australia, northern China, Mongolia and the Middle East</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fv3chem_tutorial.html" class="btn btn-neutral float-right" title="FV3-CHEM in MONET" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="CMAQ_hi_volcano.html" class="btn btn-neutral float-left" title="How to Open and View CMAQ simulations - HI Volcano Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Barry Baker

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>